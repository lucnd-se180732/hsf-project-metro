<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>V√© c·ªßa t√¥i</title>
    <link rel="stylesheet" href="/css/ticket.css">
    <style>
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .tabs a {
            padding: 8px 16px;
            background-color: #eee;
            border-radius: 5px;
            text-decoration: none;
            color: black;
        }
        .tabs a.active {
            background-color: #2196f3;
            color: white;
        }
        .pagination {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 8px;
        }
        .pagination a {
            padding: 6px 12px;
            border: 1px solid #2196f3;
            border-radius: 4px;
            text-decoration: none;
            color: #2196f3;
        }
        .pagination a.active {
            background-color: #2196f3;
            color: white;
        }
    </style>
</head>
<body>
<h1>üì¶ V√© c·ªßa t√¥i</h1>

<!-- üîò Tabs chuy·ªÉn lo·∫°i v√© -->
<div class="tabs">
    <a th:href="@{/tickets(type='active')}" th:classappend="${activeTab == 'active'} ? 'active'">ƒê√£ k√≠ch ho·∫°t</a>
    <a th:href="@{/tickets(type='inactive')}" th:classappend="${activeTab == 'inactive'} ? 'active'">Ch∆∞a k√≠ch ho·∫°t</a>
    <a th:href="@{/tickets(type='expired')}" th:classappend="${activeTab == 'expired'} ? 'active'">ƒê√£ h·∫øt h·∫°n</a>
</div>

<!-- ‚ùå Kh√¥ng c√≥ v√© -->
<div th:if="${tickets.isEmpty()}">
    <p>üö´ Hi·ªán t·∫°i b·∫°n ch∆∞a c√≥ v√© n√†o.</p>
</div>

<!-- ‚úÖ Danh s√°ch v√© -->
<div class="ticket-list-wrapper" th:if="${!tickets.isEmpty()}">
    <div th:each="ticket : ${tickets}" class="ticket-card">
        <div class="ticket-info">
            <h2 th:text="|Lo·∫°i v√©: ${ticket.ticketType.displayName}|"></h2>
            <p th:if="${ticket.departureStation != null}">
                Ga ƒëi: <span th:text="${ticket.departureStation}"></span>
                ‚Äì Ga ƒë·∫øn: <span th:text="${ticket.arrivalStation}"></span>
            </p>
            <p>Ng√†y b·∫Øt ƒë·∫ßu: <span th:text="${#temporals.format(ticket.startDate, 'dd/MM/yyyy HH:mm')}"></span></p>
            <p>Ng√†y k·∫øt th√∫c: <span th:text="${#temporals.format(ticket.endDate, 'dd/MM/yyyy HH:mm')}"></span></p>
            <p>M√¥ t·∫£: <span th:text="${ticket.description}"></span></p>
            <p>L∆∞u √Ω: <span th:text="${ticket.note}"></span></p>
            <p th:text="|Gi√°: ${ticket.price} VND|"></p>
            <p class="ticket-status">
                Tr·∫°ng th√°i:
                <span th:text="${ticket.activatedAt != null or ticket.ticketType.name() == 'SINGLE' ? 'ƒê√£ k√≠ch ho·∫°t' : 'Ch∆∞a k√≠ch ho·∫°t'}"></span>
            </p>
        </div>
        <div class="ticket-actions">
            <img th:src="|data:image/png;base64,${ticket.qrCode}|" alt="QR Code"/>
            <th:block th:if="${ticket.ticketType != T(com.hsf302.enums.TicketType).SINGLE and ticket.activatedAt == null}">
                <form th:action="@{'/tickets/activate/' + ${ticket.id}}" method="post">
                    <button type="submit">K√≠ch ho·∫°t v√©</button>
                </form>
            </th:block>
        </div>
    </div>
</div>

<!-- ‚úÖ Ph√¢n trang: ch·ªâ hi·ªán khi c√≥ nhi·ªÅu h∆°n 1 trang -->
<div class="pagination" th:if="${totalPages > 1}">
    <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
        <a th:href="@{/tickets(page=${i}, type=${activeTab})}"
           th:text="${i + 1}"
           th:classappend="${i == currentPage} ? 'active' : ''">
        </a>
    </span>
</div>

</body>
</html>
