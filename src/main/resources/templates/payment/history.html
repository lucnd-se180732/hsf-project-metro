<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>L·ªãch s·ª≠ giao d·ªãch</title>
    <link rel="stylesheet" href="/css/payment.css" />
</head>
<body>

<h1>L·ªãch s·ª≠ giao d·ªãch c·ªßa b·∫°n</h1>

<div th:if="${payments.isEmpty()}">
    <p style="text-align:center; color: gray;">Ch∆∞a c√≥ giao d·ªãch n√†o.</p>
</div>

<table th:if="${!payments.isEmpty()}">
    <thead>
    <tr>
        <th>M√£ giao d·ªãch</th>
        <th>M√£ v√©</th>
        <th>S·ªë ti·ªÅn</th>
        <th>Ng√¢n h√†ng</th>
        <th>Ph∆∞∆°ng th·ª©c</th>
        <th>Th·ªùi gian</th>
        <th>Tr·∫°ng th√°i</th>
    </tr>
    </thead>
    <tbody>
    <!-- ‚úÖ Duy·ªát 1 l·∫ßn duy nh·∫•t -->
    <th:block th:each="payment : ${payments}">
        <!-- H√†ng ch√≠nh -->
        <tr>
            <td><span th:text="${payment.transactionId}"></span></td>
            <td><span th:text="'TICKET#' + ${payment.ticket.id}"></span></td>
            <td><span th:text="${payment.amount} + ' VND'"></span></td>
            <td><span th:text="${payment.bankCode}"></span></td>
            <td><span th:text="${payment.paymentMethod}"></span></td>
            <td><span th:text="${#temporals.format(payment.paymentTime, 'dd/MM/yyyy HH:mm')}"></span></td>
            <td>
                <span th:text="${payment.success ? '‚úî Th√†nh c√¥ng' : '‚ùå Th·∫•t b·∫°i'}"
                      th:classappend="${payment.success} ? 'status-success' : 'status-failed'"></span>
            </td>
        </tr>

        <!-- H√†ng lo·∫°i v√© t∆∞∆°ng ·ª©ng -->
        <tr th:if="${payment.ticket != null}">
            <td colspan="7">
                üßæ <strong>Lo·∫°i v√©:</strong>
                <span th:text="${payment.ticket.ticketType.displayName}"></span>

                <span th:if="${payment.ticket.ticketType.name() == 'SINGLE'}">
                    ‚Äî üöâ <strong>Ga ƒëi:</strong> <span th:text="${payment.ticket.departureStation}"></span>,
                    <strong>Ga ƒë·∫øn:</strong> <span th:text="${payment.ticket.arrivalStation}"></span>
                </span>
            </td>
        </tr>
    </th:block>
    </tbody>
</table>

<!-- ‚úÖ Ph√¢n trang -->
<div class="pagination" th:if="${totalPages > 1}">
    <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
        <a th:href="@{/payments/history(page=${i})}"
           th:text="${i + 1}"
           th:classappend="${i == currentPage} ? 'active' : ''">
        </a>
    </span>
</div>

</body>
</html>
